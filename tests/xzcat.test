#!/bin/bash

# Copyright 2014 Divya Kothari <divya.s.kothari@gmail.com>
# Copyright 2014 Naha Maggu <maggu.neha@gmail.com>

[ -f testing.sh ] && . testing.sh

#testing "name" "command" "result" "infile" "stdin"

echo "hello" > file
$HOST_BIN_TAR -cJf file.xz file

$HOST_BIN_XZCAT file.xz > expected_out
testing "decompresses a single file" \
  'xzcat file.xz > Tempfile && echo yes; diff Tempfile expected_out && echo yes; rm -rf file* expected_out Tempfile' \
  "yes\nyes\n" "" ""

echo "one" > file1
echo "two" > file2
echo "three" > file3

$HOST_BIN_TAR -cJf file1.xz file1
$HOST_BIN_TAR -cJf file2.xz file2
$HOST_BIN_TAR -cJf file3.xz file3

$HOST_BIN_XZCAT file1.xz file2.xz file3.xz > expected_out

testing "decompresses multiple files" \
  'xzcat file1.xz file2.xz file3.xz > Tempfile && echo yes; diff Tempfile expected_out && echo yes' \
  "yes\nyes\n" "" ""
